---
layout: post
title: "VB.net覚え書き2"
date: 2025-10-16 00:00:00
---

## VB.net
# UI更新にTimerポーリング!?
System.Windows.Forms.Timer：TickはUIスレッドで実行される。  
UIスレッドが重い処理でブロックされているとTickが遅延する。  
背景処理は別スレッドで行うべき。

イベント駆動でUIに通知  
Public Event StatusChanged(ByVal newState As Boolean)  
RaiseEvent StatusChanged(True)

フォーム側  
AddHandler background.StatusChanged, Sub(newState As Boolean)  
　　If Me.InvokeRequired Then  
　　　　Me.BeginInvoke(Sub() UpdateUI(newState))  
　　Else  
　　　　UpdateUI(newState)  
　　End If  
End Sub

Private Sub UpdateUI(state As Boolean)  
　　label1.Text = If(state, "処理中", "待機")  
End Sub
