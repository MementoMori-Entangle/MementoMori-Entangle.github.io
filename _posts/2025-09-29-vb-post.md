---
layout: post
title: "VB.net覚え書き"
date: 2025-09-29 00:00:00
---

## VB.net
# exeアプリを起動する方法
Dim exePath As String = "C:\Windows\System32\notepad.exe"  
System.Diagnostics.Process.Start(exePath)  

Dim startInfo As New ProcessStartInfo()  
startInfo.FileName = "C:\Path\To\YourApp.exe"  
startInfo.Arguments = "-option1 value1"  
startInfo.WorkingDirectory = "C:\Path\To"  
Process.Start(startInfo)  

# アプリをアクティブ状態にしてウィンドウのトップ
Imports System.Diagnostics  
Imports System.Runtime.InteropServices  

' Win32 API宣言  
<DllImport("user32.dll")>  
Private Shared Function SetForegroundWindow(hWnd As IntPtr) As Boolean  
End Function  

<DllImport("user32.dll")>  
Private Shared Function ShowWindow(hWnd As IntPtr, nCmdShow As Integer) As Boolean  
End Function  

Private Const SW_RESTORE As Integer = 9  

Dim exeName As String = "notepad" ' 拡張子なし  
Dim exePath As String = "C:\Windows\System32\notepad.exe"  

' すでに起動中かどうか確認  
Dim processes As Process() = Process.GetProcessesByName(exeName)  
If processes.Length > 0 Then  
    ' すでに起動している場合、ウィンドウをアクティブ化  
    Dim hWnd As IntPtr = processes(0).MainWindowHandle  
    If hWnd <> IntPtr.Zero Then  
        ' 最小化されていた場合は元に戻す  
        ShowWindow(hWnd, SW_RESTORE)  
        ' 最前面にする  
        SetForegroundWindow(hWnd)  
    End If  
Else  
   ' 起動していなければ新規起動  
   Process.Start(exePath)  
End If  

